<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SyntaxBet - Word Formation Challenge</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #0a2e5a;
            --secondary: #1a4789;
            --accent: #4cc9f0;
            --accent-gradient: linear-gradient(to right, #4cc9f0, #4895ef);
            --text-light: #ffffff;
            --text-gray: #a0c1ed;
            --card-bg: #1a3e75;
            --card-dark: #0f2b50;
            --success: #4cc9f0;
            --warning: #f8961e;
            --danger: #e63946;
            --border-radius: 12px;
            --box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: var(--text-light);
            min-height: 100vh;
            padding: 10px;
            overflow-x: hidden;
            font-size: 12px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            width: 100%;
        }

        header {
            text-align: center;
            margin-bottom: 15px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            animation: fadeIn 0.8s ease;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            position: relative;
        }

        h1 {
            color: var(--text-light);
            font-size: 1.6rem;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        h1 i {
            color: var(--accent);
            font-size: 1.4rem;
        }

        .subtitle {
            color: var(--text-gray);
            font-size: 0.8rem;
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.4;
        }

        .header-buttons {
            position: absolute;
            top: 15px;
            right: 15px;
            display: flex;
            gap: 8px;
        }

        .header-btn {
            padding: 6px 10px;
            background: rgba(255, 255, 255, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            color: var(--text-light);
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 5px;
            font-weight: 600;
            font-size: 0.7rem;
        }

        .header-btn:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateY(-2px);
        }

        .game-area {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }

        @media (max-width: 900px) {
            .game-area {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .header-buttons {
                position: static;
                justify-content: center;
                margin-top: 10px;
            }
        }

        .panel {
            background: rgba(255, 255, 255, 0.1);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 15px;
            animation: slideUp 0.5s ease;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .panel-title {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--text-light);
            font-size: 1rem;
        }

        .panel-title i {
            font-size: 0.9rem;
            color: var(--accent);
        }

        .topic-box {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 15px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            font-family: monospace;
            white-space: pre-wrap;
            line-height: 1.4;
            max-height: 200px;
            overflow-y: auto;
            position: relative;
            font-size: 0.8rem;
        }

        .corrections-btn {
            position: absolute;
            top: 8px;
            right: 8px;
            background: var(--accent-gradient);
            color: var(--primary);
            border: none;
            border-radius: 4px;
            padding: 5px 8px;
            font-size: 0.6rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 4px;
            box-shadow: 0 3px 10px rgba(76, 201, 240, 0.4);
        }

        .corrections-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(76, 201, 240, 0.6);
        }

        .betting-controls {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 15px;
        }

        .bet-amount {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .bet-input {
            flex: 1;
            padding: 8px 10px;
            border-radius: 6px;
            border: none;
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-light);
            font-size: 0.8rem;
        }

        .bet-input::placeholder {
            color: var(--text-gray);
        }

        /* Updated word buttons - 4 per column, 2 rows */
        .word-buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 6px;
        }

        @media (max-width: 600px) {
            .word-buttons {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        .word-btn {
            padding: 6px 4px;
            border: none;
            border-radius: 4px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            background: var(--card-bg);
            color: var(--text-light);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 40px;
        }

        .word-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .word-btn.active {
            background: var(--accent-gradient);
            color: var(--primary);
            box-shadow: 0 5px 15px rgba(76, 201, 240, 0.4);
        }

        .word-btn .btn-label {
            font-size: 0.7rem;
            font-weight: bold;
        }

        .word-btn .btn-payout {
            font-size: 0.6rem;
            opacity: 0.8;
        }

        .place-bet-btn {
            padding: 8px;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            background: var(--accent-gradient);
            color: var(--primary);
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            margin-top: 8px;
            box-shadow: 0 5px 15px rgba(76, 201, 240, 0.4);
        }

        .place-bet-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(76, 201, 240, 0.6);
        }

        .place-bet-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* Larger number buttons */
        .numbers-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(45px, 1fr));
            gap: 6px;
            margin-bottom: 15px;
            max-height: 250px;
            overflow-y: auto;
            padding: 8px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 6px;
        }

        .number {
            background: var(--card-bg);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.9rem;
            cursor: pointer;
            transition: var(--transition);
            user-select: none;
            color: var(--text-light);
        }

        .number:hover {
            transform: translateY(-3px);
            border-color: var(--accent);
            box-shadow: 0 5px 15px rgba(76, 201, 240, 0.2);
        }

        .number.selected {
            background: var(--accent-gradient);
            color: var(--primary);
            border-color: var(--accent);
        }

        .number.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .sentence-area {
            min-height: 80px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 6px;
            border: 2px dashed rgba(255, 255, 255, 0.2);
            margin-bottom: 15px;
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            align-items: center;
        }

        .sentence-word {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid var(--accent);
            padding: 6px 10px;
            border-radius: 4px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 6px;
            animation: popIn 0.3s ease;
            box-shadow: 0 3px 10px rgba(76, 201, 240, 0.1);
            color: var(--text-light);
            font-size: 0.8rem;
        }

        .controls {
            display: flex;
            gap: 8px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        button {
            padding: 8px 12px;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.7rem;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--secondary);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(10, 46, 90, 0.3);
        }

        .btn-secondary {
            background: var(--accent);
            color: var(--primary);
        }

        .btn-secondary:hover {
            background: #3ab0d9;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(76, 201, 240, 0.3);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-success:hover {
            background: #3ab0d9;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(76, 201, 240, 0.3);
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-danger:hover {
            background: #d32f2f;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(230, 57, 70, 0.3);
        }

        .ai-response {
            background: rgba(255, 255, 255, 0.1);
            border-left: 3px solid var(--accent);
            padding: 15px;
            border-radius: 6px;
            margin-top: 15px;
            display: none;
            animation: slideIn 0.5s ease;
            font-size: 0.8rem;
        }

        .ai-response.show {
            display: block;
        }

        .ai-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
            color: var(--accent);
            font-size: 0.9rem;
        }

        .ai-header i {
            font-size: 1.1rem;
        }

        .score-display {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
            flex-wrap: wrap;
            gap: 10px;
        }

        .score-item {
            text-align: center;
            flex: 1;
            min-width: 70px;
        }

        .score-value {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--accent);
        }

        .score-label {
            font-size: 0.7rem;
            color: var(--text-gray);
        }

        .examples {
            margin-top: 15px;
        }

        .examples-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .example {
            background: rgba(255, 255, 255, 0.1);
            padding: 10px;
            border-radius: 6px;
            border-left: 3px solid var(--accent);
            font-size: 0.7rem;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
        }

        .rules {
            margin-top: 15px;
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            font-size: 0.8rem;
        }

        .rules ul {
            padding-left: 15px;
            margin-top: 8px;
        }

        .rules li {
            margin-bottom: 6px;
            line-height: 1.4;
        }

        footer {
            text-align: center;
            margin-top: 25px;
            padding: 15px;
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.7rem;
        }

        /* Timer Styles */
        .timer-container {
            display: flex;
            justify-content: center;
            margin-bottom: 15px;
        }

        .timer {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 30px;
            padding: 10px 20px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        .timer.running {
            color: var(--accent);
            border-color: var(--accent);
        }

        .timer.warning {
            color: var(--warning);
            border-color: var(--warning);
            animation: pulse 1s infinite;
        }

        .timer.danger {
            color: var(--danger);
            border-color: var(--danger);
            animation: pulse 0.5s infinite;
        }

        /* Overlay Styles */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }

        .overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .overlay-content {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            border-radius: var(--border-radius);
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            padding: 20px;
            position: relative;
            transform: translateY(20px);
            transition: var(--transition);
            font-size: 0.8rem;
        }

        .overlay.active .overlay-content {
            transform: translateY(0);
        }

        .overlay-close {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-light);
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.9rem;
        }

        .overlay-close:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: rotate(90deg);
        }

        .overlay-title {
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 1.2rem;
        }

        .overlay-title i {
            color: var(--accent);
        }

        .help-examples {
            margin-bottom: 15px;
        }

        .help-examples-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .help-example {
            background: rgba(255, 255, 255, 0.1);
            padding: 10px;
            border-radius: 6px;
            border-left: 3px solid var(--accent);
            font-size: 0.7rem;
        }

        .help-rules {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 6px;
            margin-top: 15px;
        }

        .help-rules ul {
            padding-left: 15px;
            margin-top: 8px;
        }

        .help-rules li {
            margin-bottom: 6px;
            line-height: 1.4;
        }

        /* Game Records Styles - moved to bottom */
        .records-container {
            margin-top: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: var(--border-radius);
            padding: 15px;
            max-height: 300px;
            overflow-y: auto;
        }

        .records-title {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 10px;
            color: var(--accent);
            font-size: 0.9rem;
        }

        .records-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.7rem;
        }

        .records-table th {
            text-align: left;
            padding: 8px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--text-gray);
        }

        .records-table td {
            padding: 8px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .records-table tr:last-child td {
            border-bottom: none;
        }

        .win-amount {
            color: var(--success);
            font-weight: bold;
        }

        .loss-amount {
            color: var(--danger);
            font-weight: bold;
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        @keyframes slideIn {
            from { transform: translateX(-20px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes popIn {
            0% { transform: scale(0.8); opacity: 0; }
            70% { transform: scale(1.05); }
            100% { transform: scale(1); opacity: 1; }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(76, 201, 240, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(76, 201, 240, 0); }
            100% { box-shadow: 0 0 0 0 rgba(76, 201, 240, 0); }
        }

        .notification {
            position: fixed;
            top: 15px;
            right: 15px;
            padding: 10px 15px;
            border-radius: 6px;
            color: white;
            font-weight: 500;
            z-index: 1000;
            animation: slideIn 0.5s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            max-width: 250px;
            font-size: 0.7rem;
        }

        .notification.success {
            background: var(--success);
        }

        .notification.error {
            background: var(--danger);
        }

        .notification.info {
            background: var(--accent);
        }

        .loading {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Mobile-specific adjustments */
        @media (max-width: 768px) {
            h1 {
                font-size: 1.4rem;
            }
            
            .subtitle {
                font-size: 0.7rem;
            }
            
            .panel {
                padding: 12px;
            }
            
            .numbers-grid {
                grid-template-columns: repeat(auto-fill, minmax(40px, 1fr));
                gap: 5px;
            }
            
            .number {
                height: 40px;
                font-size: 0.8rem;
            }
            
            button {
                padding: 6px 10px;
                font-size: 0.65rem;
            }
            
            .controls {
                gap: 6px;
            }
            
            .score-item {
                min-width: 60px;
            }
            
            .score-value {
                font-size: 1rem;
            }
            
            .overlay-content {
                padding: 15px;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 8px;
            }
            
            header {
                padding: 12px 8px;
            }
            
            h1 {
                font-size: 1.2rem;
            }
            
            .game-area {
                gap: 12px;
            }
            
            .numbers-grid {
                grid-template-columns: repeat(auto-fill, minmax(35px, 1fr));
            }
            
            .number {
                height: 35px;
                font-size: 0.7rem;
            }
            
            .controls {
                flex-direction: column;
            }
            
            button {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-water"></i> SyntaxBet</h1>
            <p class="subtitle">Form meaningful phrases, clauses, or sentences by selecting words in the rightward order. Challenge your syntax skills with our AI-powered evaluation system.</p>
            
            <div class="header-buttons">
                <button class="header-btn" id="helpBtn">
                    <i class="fas fa-question-circle"></i> Help
                </button>
                <button class="header-btn" id="correctionsBtn">
                    <i class="fas fa-edit"></i> Corrections
                </button>
            </div>
        </header>

        <div class="timer-container">
            <div class="timer" id="timer">
                <i class="fas fa-clock"></i>
                <span id="timerValue">02:00</span>
            </div>
        </div>

        <div class="game-area">
            <div class="panel">
                <h2 class="panel-title"><i class="fas fa-comments"></i> Topic & Betting</h2>
                
                <div class="topic-box" id="topicBox">
                    Loading topic...
                </div>

                <div class="betting-controls">
                    <div class="bet-amount">
                        <input type="number" class="bet-input" id="betAmount" placeholder="Enter bet amount" min="1" value="10">
                    </div>

                    <div class="word-buttons">
                        <button class="word-btn" data-words="3">
                            <span class="btn-label">W3</span>
                            <span class="btn-payout">Payout: 2x</span>
                        </button>
                        <button class="word-btn" data-words="4">
                            <span class="btn-label">W4</span>
                            <span class="btn-payout">Payout: 3x</span>
                        </button>
                        <button class="word-btn" data-words="5">
                            <span class="btn-label">W5</span>
                            <span class="btn-payout">Payout: 4x</span>
                        </button>
                        <button class="word-btn" data-words="6">
                            <span class="btn-label">W6</span>
                            <span class="btn-payout">Payout: 5x</span>
                        </button>
                        <button class="word-btn" data-words="7">
                            <span class="btn-label">W7</span>
                            <span class="btn-payout">Payout: 6x</span>
                        </button>
                        <button class="word-btn" data-words="8">
                            <span class="btn-label">W8</span>
                            <span class="btn-payout">Payout: 7x</span>
                        </button>
                        <button class="word-btn" data-words="9">
                            <span class="btn-label">W9</span>
                            <span class="btn-payout">Payout: 8x</span>
                        </button>
                        <button class="word-btn" data-words="10">
                            <span class="btn-label">W10</span>
                            <span class="btn-payout">Payout: 10x</span>
                        </button>
                    </div>

                    <button class="place-bet-btn" id="placeBetBtn" disabled>
                        <i class="fas fa-coins"></i> Place Bet
                    </button>
                </div>

                <div class="score-display">
                    <div class="score-item">
                        <div class="score-value" id="balanceValue">1000</div>
                        <div class="score-label">Balance</div>
                    </div>
                    <div class="score-item">
                        <div class="score-value" id="winValue">0</div>
                        <div class="score-label">Winnings</div>
                    </div>
                    <div class="score-item">
                        <div class="score-value" id="betValue">0</div>
                        <div class="score-label">Current Bet</div>
                    </div>
                </div>
            </div>

            <div class="panel">
                <h2 class="panel-title"><i class="fas fa-th-large"></i> Word Selection & Sentence Construction</h2>
                
                <div class="numbers-grid" id="numbersGrid">
                    <!-- Numbers 1-100 will be generated by JavaScript -->
                </div>

                <div class="sentence-area" id="sentenceArea">
                    <!-- Words will appear here when selected -->
                    <p id="placeholderText">Select words to build your sentence...</p>
                </div>

                <div class="ai-response" id="aiResponse">
                    <div class="ai-header">
                        <i class="fas fa-robot"></i>
                        <h3>AI Evaluation</h3>
                    </div>
                    <div id="aiText">Waiting for evaluation...</div>
                </div>
            </div>
        </div>

        <!-- Game Records moved to bottom of page -->
        <div class="records-container">
            <h3 class="records-title"><i class="fas fa-history"></i> Game Records</h3>
            <table class="records-table" id="recordsTable">
                <thead>
                    <tr>
                        <th>Word Length</th>
                        <th>You Arranged</th>
                        <th>Date</th>
                        <th>Winning</th>
                    </tr>
                </thead>
                <tbody id="recordsBody">
                    <!-- Records will be populated here -->
                </tbody>
            </table>
        </div>

        <footer>
            <p>SyntaxBet &copy; 2026 | Part of the EnglaBet Language Learning System</p>
        </footer>
    </div>

    <!-- Help Overlay -->
    <div class="overlay" id="helpOverlay">
        <div class="overlay-content">
            <button class="overlay-close" id="helpClose">
                <i class="fas fa-times"></i>
            </button>
            <h2 class="overlay-title"><i class="fas fa-question-circle"></i> Game Help</h2>
            
            <div class="help-examples">
                <h3 class="panel-title"><i class="fas fa-lightbulb"></i> Example Sentences</h3>
                <div class="help-examples-grid">
                    <div class="help-example">W3: [I] [AM] [HERE]</div>
                    <div class="help-example">W4: [BRING] [BACK] [MY] [PHONE]</div>
                    <div class="help-example">W5: [STAY] [WITH] [US] [FOR] [NOW]</div>
                    <div class="help-example">W6: [IT] [ONLY] [WORKS] [FOR] [YOUNG] [PEOPLE]</div>
                    <div class="help-example">W7: [YOU] [CANNOT] [GO] [TO] [THE] [GYM] [ALONE]</div>
                    <div class="help-example">W8: [WHY] [IS] [IT] [TAKING] [TOO] [LONG] [TO] [LAND]</div>
                </div>
            </div>
            
            <div class="help-rules">
                <h3 class="panel-title"><i class="fas fa-info-circle"></i> Game Rules</h3>
                <ul>
                    <li>Place a bet and select a word count (W3-W10)</li>
                    <li>Select the specified number of words from the number grid</li>
                    <li>Words appear directly in the sentence area when selected</li>
                    <li>Words must be arranged in the correct grammatical order</li>
                    <li>Your sentence will be automatically validated when all words are selected</li>
                    <li>Win your bet multiplied by the payout rate if your sentence is valid</li>
                    <li>Challenge yourself to create more complex sentences for higher payouts</li>
                    <li>Each round has a 2-minute time limit</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        // Game state
        let selectedNumbers = [];
        let sentenceWords = [];
        let balance = 1000;
        let currentBet = 0;
        let selectedWordCount = 3; // Default to W3
        let currentTopic = "";
        let wordDatabase = {};
        let roundActive = false;
        let timerInterval;
        let timeLeft = 120; // 2 minutes in seconds
        let gameRecords = [];

        // DOM elements
        const numbersGrid = document.getElementById('numbersGrid');
        const sentenceArea = document.getElementById('sentenceArea');
        const placeholderText = document.getElementById('placeholderText');
        const topicBox = document.getElementById('topicBox');
        const betAmountInput = document.getElementById('betAmount');
        const placeBetBtn = document.getElementById('placeBetBtn');
        const wordButtons = document.querySelectorAll('.word-btn');
        const aiResponse = document.getElementById('aiResponse');
        const aiText = document.getElementById('aiText');
        const balanceValue = document.getElementById('balanceValue');
        const winValue = document.getElementById('winValue');
        const betValue = document.getElementById('betValue');
        const timerElement = document.getElementById('timer');
        const timerValue = document.getElementById('timerValue');
        const helpBtn = document.getElementById('helpBtn');
        const helpOverlay = document.getElementById('helpOverlay');
        const helpClose = document.getElementById('helpClose');
        const correctionsBtn = document.getElementById('correctionsBtn');
        const recordsBody = document.getElementById('recordsBody');

        // Google AI Studio API key
        const GOOGLE_AI_API_KEY = "AIzaSyC5GqryX1qgFzT-iAJMdsajqiNPAAhm70o";

        // Initialize the game
        function initGame() {
            // Generate random topic using Google AI API
            generateRandomTopic();
            
            // Create number grid
            numbersGrid.innerHTML = '';
            for (let i = 1; i <= 100; i++) {
                const numberElement = document.createElement('div');
                numberElement.className = 'number';
                numberElement.textContent = i;
                numberElement.dataset.number = i;
                
                numberElement.addEventListener('click', () => {
                    toggleNumberSelection(i, numberElement);
                });
                
                numbersGrid.appendChild(numberElement);
            }

            // Event listeners
            placeBetBtn.addEventListener('click', placeBet);
            helpBtn.addEventListener('click', showHelp);
            helpClose.addEventListener('click', hideHelp);
            correctionsBtn.addEventListener('click', showCorrections);
            
            // Word button event listeners
            wordButtons.forEach(button => {
                button.addEventListener('click', () => {
                    selectWordCount(parseInt(button.dataset.words));
                });
            });

            // Set default word count to W3
            selectWordCount(3);

            // Start the timer always
            startTimer();

            // Update UI
            updateUI();
        }

        // Generate random topic using Google AI Studio API
        async function generateRandomTopic() {
            topicBox.innerHTML = '<div class="loading"></div> Generating topic...';
            
            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${GOOGLE_AI_API_KEY}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: "Generate a short dialogue between two people on a random everyday topic. The dialogue should be between 4-8 lines total, with each line being a complete sentence. Format it like this example:\n\nDialogue Bank [Topic] ⬇\n\nPERSON1: [FIRST SENTENCE] [SECOND SENTENCE]\nPERSON2: [THIRD SENTENCE] [FOURTH SENTENCE]\n\nPlease create a completely different dialogue on a new topic. Do not use restaurant or food-related topics."
                            }]
                        }],
                        generationConfig: {
                            temperature: 0.8,
                            maxOutputTokens: 300,
                        }
                    })
                });

                if (!response.ok) {
                    throw new Error('Failed to generate topic');
                }

                const data = await response.json();
                const generatedTopic = data.candidates[0].content.parts[0].text;
                
                currentTopic = generatedTopic;
                topicBox.textContent = generatedTopic;
                
                // Generate word database based on topic
                generateWordDatabase(generatedTopic);
            } catch (error) {
                console.error('Error generating topic:', error);
                // Fallback to a default topic if API fails
                const fallbackTopic = `Dialogue Bank [Travel Plans] ⬇

PERSON1: [WHERE ARE YOU PLANNING TO GO] [WHEN WILL YOU LEAVE]
PERSON2: [I WANT TO VISIT JAPAN] [I WILL TRAVEL NEXT MONTH]
PERSON1: [HOW LONG WILL YOU STAY] [HAVE YOU BOOKED YOUR FLIGHT]
PERSON2: [I WILL STAY FOR TWO WEEKS] [I NEED TO FIND A HOTEL FIRST]`;
                
                currentTopic = fallbackTopic;
                topicBox.textContent = fallbackTopic;
                generateWordDatabase(fallbackTopic);
            }
        }

        // Generate word database from topic
        function generateWordDatabase(topic) {
            wordDatabase = {};
            
            // Extract words from the topic
            const words = topic
                .replace(/[\[\]]/g, ' ') // Remove brackets
                .replace(/[^\w\s]/g, '') // Remove punctuation
                .toUpperCase()
                .split(/\s+/)
                .filter(word => word.length > 1) // Remove single letters
                .filter((word, index, self) => self.indexOf(word) === index); // Remove duplicates
            
            // Fill the rest with random words if needed
            const dictionaryWords = [
                "ABOUT", "AFTER", "AGAIN", "AIR", "ALL", "ALONG", "ALSO", "AN", "AND", "ANOTHER", "ANY", "ARE", "AROUND", "AS", "AT", "AWAY", "BACK", "BE", "BECAUSE", "BEEN", "BEFORE", "BEGAN", "BEST", "BETTER", "BIG", "BLACK", "BLUE", "BOOK", "BOTH", "BOX", "BRING", "BUT", "BY", "CALL", "CAME", "CAN", "CAR", "CARE", "CARRIED", "CARRY", "CHANGE", "CITY", "CLOSE", "COME", "COULD", "CUT", "DARK", "DAY", "DID", "DIFFERENT", "DO", "DOES", "DONT", "DOWN", "EACH", "END", "EVEN", "EVERY", "EYE", "FACE", "FALL", "FAR", "FARM", "FAST", "FATHER", "FEET", "FEW", "FIND", "FIRST", "FIVE", "FLY", "FOOD", "FOR", "FORM", "FOUND", "FOUR", "FROM", "FULL", "GAVE", "GET", "GIVE", "GO", "GOING", "GOOD", "GOT", "GREAT", "GREEN", "GROW", "HAD", "HAND", "HARD", "HAS", "HAVE", "HE", "HEAD", "HEAR", "HELP", "HER", "HERE", "HIGH", "HIM", "HIS", "HOME", "HOUSE", "HOW", "I", "IF", "IN", "INTO", "IS", "IT", "ITS", "JUST", "KEEP", "KIND", "KNOW", "LAND", "LARGE", "LAST", "LATE", "LAUGH", "LEARN", "LEFT", "LET", "LETTER", "LIFE", "LIGHT", "LIKE", "LINE", "LISTEN", "LITTLE", "LIVE", "LONG", "LOOK", "MADE", "MAKE", "MAN", "MANY", "MAY", "ME", "MEN", "MIGHT", "MILE", "MISS", "MORE", "MOST", "MOTHER", "MOUNTAIN", "MOVE", "MUCH", "MUST", "MY", "MYSELF", "NAME", "NEAR", "NEED", "NEVER", "NEW", "NEXT", "NIGHT", "NO", "NOT", "NOW", "NUMBER", "OF", "OFF", "OLD", "ON", "ONCE", "ONE", "ONLY", "OPEN", "OR", "OTHER", "OUR", "OUT", "OVER", "OWN", "PAGE", "PART", "PEOPLE", "PICTURE", "PLACE", "PLAY", "POINT", "PUT", "READ", "RED", "RIGHT", "ROOM", "RUN", "SAID", "SAME", "SAW", "SAY", "SCHOOL", "SEE", "SEEM", "SENTENCE", "SET", "SHE", "SHOULD", "SHOW", "SIDE", "SMALL", "SO", "SOME", "SOMETHING", "SOON", "SOUND", "SPELL", "START", "STATE", "STILL", "STOP", "STORY", "STUDY", "SUCH", "TAKE", "TALK", "TELL", "THAN", "THAT", "THE", "THEIR", "THEM", "THEN", "THERE", "THESE", "THEY", "THING", "THINK", "THIS", "THOSE", "THOUGHT", "THREE", "THROUGH", "TIME", "TO", "TOGETHER", "TOO", "TOOK", "TREE", "TURN", "TWO", "UNDER", "UP", "US", "USE", "VERY", "WALK", "WANT", "WAS", "WATCH", "WATER", "WAY", "WE", "WELL", "WENT", "WERE", "WHAT", "WHEN", "WHERE", "WHICH", "WHILE", "WHITE", "WHO", "WHY", "WILL", "WITH", "WORD", "WORK", "WORLD", "WOULD", "WRITE", "YEAR", "YES", "YOU", "YOUR"
            ];
            
            // Shuffle dictionary words
            const shuffledDictionary = [...dictionaryWords].sort(() => 0.5 - Math.random());
            
            // Create an array of all numbers from 1 to 100
            const allNumbers = Array.from({length: 100}, (_, i) => i + 1);
            
            // Shuffle the numbers randomly
            const shuffledNumbers = [...allNumbers].sort(() => 0.5 - Math.random());
            
            // Assign words to shuffled numbers
            for (let i = 0; i < 100; i++) {
                if (i < words.length) {
                    wordDatabase[shuffledNumbers[i]] = words[i];
                } else {
                    wordDatabase[shuffledNumbers[i]] = shuffledDictionary[i - words.length] || "WORD";
                }
            }
        }

        // Select word count
        function selectWordCount(count) {
            selectedWordCount = count;
            
            // Update UI
            wordButtons.forEach(button => {
                if (parseInt(button.dataset.words) === count) {
                    button.classList.add('active');
                } else {
                    button.classList.remove('active');
                }
            });
            
            // Enable/disable place bet button
            placeBetBtn.disabled = !(selectedWordCount > 0 && betAmountInput.value > 0);
        }

        // Place bet
        function placeBet() {
            const betAmount = parseInt(betAmountInput.value);
            
            if (betAmount <= 0) {
                showNotification('Please enter a valid bet amount', 'error');
                return;
            }
            
            if (betAmount > balance) {
                showNotification('Insufficient balance', 'error');
                return;
            }
            
            if (selectedWordCount < 3 || selectedWordCount > 10) {
                showNotification('Please select a word count between 3 and 10', 'error');
                return;
            }
            
            // Reset timer to 120 seconds when placing a bet
            resetTimer();
            
            // Deduct bet from balance
            balance -= betAmount;
            currentBet = betAmount;
            
            // Start the round
            roundActive = true;
            
            // Update UI
            updateUI();
            
            // Disable betting controls
            betAmountInput.disabled = true;
            placeBetBtn.disabled = true;
            wordButtons.forEach(button => {
                button.disabled = true;
            });
            
            showNotification(`Bet placed: ${betAmount} coins on W${selectedWordCount}`, 'success');
        }

        // Reset timer to 120 seconds
        function resetTimer() {
            timeLeft = 120;
            updateTimerDisplay();
            
            // Clear any existing timer
            if (timerInterval) {
                clearInterval(timerInterval);
            }
            
            // Start new timer
            timerInterval = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();
                
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    if (roundActive) {
                        endRound(false, "Time's up!");
                    } else {
                        // Reset timer for new round
                        timeLeft = 120;
                        updateTimerDisplay();
                    }
                }
            }, 1000);
        }

        // Start the countdown timer (always running)
        function startTimer() {
            timeLeft = 120; // Reset to 2 minutes
            updateTimerDisplay();
            
            // Clear any existing timer
            if (timerInterval) {
                clearInterval(timerInterval);
            }
            
            // Start new timer
            timerInterval = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();
                
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    if (roundActive) {
                        endRound(false, "Time's up!");
                    } else {
                        // Reset timer for new round
                        timeLeft = 120;
                        updateTimerDisplay();
                    }
                }
            }, 1000);
        }

        // Update timer display
        function updateTimerDisplay() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            timerValue.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            // Update timer styling based on time remaining
            timerElement.className = 'timer';
            if (timeLeft <= 30) {
                timerElement.classList.add('danger');
            } else if (timeLeft <= 60) {
                timerElement.classList.add('warning');
            } else {
                timerElement.classList.add('running');
            }
        }

        // End the current round
        function endRound(isWin, message) {
            roundActive = false;
            
            // Clear timer
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }
            
            // Show notification
            showNotification(message, isWin ? 'success' : 'error');
            
            // Reset timer display
            timerElement.className = 'timer';
            timerValue.textContent = '02:00';
            
            // Automatically start next round after a delay
            setTimeout(startNewRound, 3000);
        }

        // Start new round
        function startNewRound() {
            // Reset game state
            selectedNumbers = [];
            sentenceWords = [];
            currentBet = 0;
            // Note: selectedWordCount is NOT reset - it persists between rounds
            roundActive = false;
            
            // Clear UI
            sentenceArea.innerHTML = '';
            placeholderText.style.display = 'block';
            aiResponse.classList.remove('show');
            
            // Reset number grid
            document.querySelectorAll('.number').forEach(number => {
                number.classList.remove('selected', 'disabled');
            });
            
            // Enable betting controls
            betAmountInput.disabled = false;
            placeBetBtn.disabled = false;
            wordButtons.forEach(button => {
                button.disabled = false;
                // Keep the active word count button selected
                if (parseInt(button.dataset.words) === selectedWordCount) {
                    button.classList.add('active');
                }
            });
            
            // Generate new topic
            generateRandomTopic();
            
            // Start the timer again
            startTimer();
            
            // Update UI
            updateUI();
            
            showNotification('New round started! Place your bet.', 'info');
        }

        // Toggle number selection
        function toggleNumberSelection(number, element) {
            if (!roundActive) {
                showNotification('Please place a bet first', 'error');
                return;
            }
            
            const index = selectedNumbers.indexOf(number);
            
            if (index === -1) {
                // Check if we've reached the maximum
                if (selectedNumbers.length >= selectedWordCount) {
                    showNotification(`You can only select ${selectedWordCount} words`, 'error');
                    return;
                }
                
                // Add to selection
                selectedNumbers.push(number);
                element.classList.add('selected');
                
                // Add word to sentence area
                addWordToSentence(number, wordDatabase[number]);
                
                // Auto-submit when all words are selected
                if (selectedNumbers.length === selectedWordCount) {
                    document.querySelectorAll('.number').forEach(num => {
                        if (!num.classList.contains('selected')) {
                            num.classList.add('disabled');
                        }
                    });
                    
                    // Auto-validate the sentence
                    setTimeout(validateSentence, 500);
                }
            }
        }

        // Add word to sentence area
        function addWordToSentence(number, word) {
            // Hide placeholder
            placeholderText.style.display = 'none';
            
            const wordElement = document.createElement('div');
            wordElement.className = 'sentence-word';
            wordElement.textContent = word;
            wordElement.dataset.number = number;
            
            sentenceArea.appendChild(wordElement);
            
            sentenceWords.push({ number, word, element: wordElement });
        }

        // Validate sentence
        async function validateSentence() {
            if (!roundActive) {
                showNotification('Please place a bet first', 'error');
                return;
            }
            
            if (sentenceWords.length !== selectedWordCount) {
                showNotification(`Sentence must contain exactly ${selectedWordCount} words`, 'error');
                return;
            }
            
            const sentence = sentenceWords.map(item => item.word).join(' ');
            
            try {
                // Use AI to validate the sentence
                const isValid = await validateSentenceWithAI(sentence, currentTopic);
                
                if (isValid) {
                    // Calculate winnings based on word count
                    const payoutMultipliers = {
                        3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 10
                    };
                    
                    const winnings = currentBet * payoutMultipliers[selectedWordCount];
                    balance += winnings;
                    
                    // Update UI
                    winValue.textContent = winnings;
                    updateUI();
                    
                    // Add record
                    addGameRecord(selectedWordCount, sentence, winnings);
                    
                    // Show AI evaluation
                    showAIEvaluation(sentence, true, winnings);
                    
                    // End the round with win
                    endRound(true, `Congratulations! You won ${winnings} coins!`);
                } else {
                    // Add record with loss
                    addGameRecord(selectedWordCount, sentence, 0);
                    
                    showAIEvaluation(sentence, false, 0);
                    // End the round with loss
                    endRound(false, 'Sentence does not match the topic. Try again next round!');
                }
            } catch (error) {
                console.error('Error validating sentence:', error);
                // Fallback to random validation if AI fails
                const isValid = Math.random() > 0.3; // 70% chance of being valid for demo
                
                if (isValid) {
                    const payoutMultipliers = {
                        3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 7, 9: 8, 10: 10
                    };
                    
                    const winnings = currentBet * payoutMultipliers[selectedWordCount];
                    balance += winnings;
                    
                    winValue.textContent = winnings;
                    updateUI();
                    
                    // Add record
                    addGameRecord(selectedWordCount, sentence, winnings);
                    
                    showAIEvaluation(sentence, true, winnings);
                    // End the round with win
                    endRound(true, `Congratulations! You won ${winnings} coins!`);
                } else {
                    // Add record with loss
                    addGameRecord(selectedWordCount, sentence, 0);
                    
                    showAIEvaluation(sentence, false, 0);
                    // End the round with loss
                    endRound(false, 'Sentence does not match the topic. Try again next round!');
                }
            }
        }

        // Validate sentence with AI
        async function validateSentenceWithAI(sentence, topic) {
            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${GOOGLE_AI_API_KEY}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: `Evaluate if the following sentence is grammatically correct and makes sense in the context of the dialogue topic. Return only "valid" or "invalid".\n\nTopic: ${topic}\nSentence: ${sentence}`
                            }]
                        }],
                        generationConfig: {
                            temperature: 0.1,
                            maxOutputTokens: 10,
                        }
                    })
                });

                if (!response.ok) {
                    throw new Error('Failed to validate sentence');
                }

                const data = await response.json();
                const result = data.candidates[0].content.parts[0].text.trim().toLowerCase();
                
                // Return true if the prediction is "valid"
                return result === "valid";
            } catch (error) {
                console.error('Error with AI validation:', error);
                throw error;
            }
        }

        // Show AI evaluation
        function showAIEvaluation(sentence, isValid, winnings) {
            let evaluation = "";
            
            if (isValid) {
                evaluation = `
                    <p>Your sentence "<strong>${sentence}</strong>" is valid and matches the topic!</p>
                    <p>You won <strong>${winnings} coins</strong>!</p>
                    <p>The sentence follows proper grammatical structure and makes sense in the context of the dialogue.</p>
                `;
            } else {
                evaluation = `
                    <p>Your sentence "<strong>${sentence}</strong>" does not properly match the topic.</p>
                    <p>Try to create a sentence that fits within the context of the dialogue provided.</p>
                    <p>Consider the relationships between the characters and the situation described.</p>
                `;
            }
            
            aiText.innerHTML = evaluation;
            aiResponse.classList.add('show');
        }

        // Add game record
        function addGameRecord(wordLength, arranged, winning) {
            const now = new Date();
            const dateStr = now.toLocaleDateString() + ' ' + now.toLocaleTimeString();
            
            const record = {
                wordLength: `W${wordLength}`,
                arranged: arranged,
                date: dateStr,
                winning: winning
            };
            
            gameRecords.unshift(record); // Add to beginning of array
            
            // Keep only last 10 records
            if (gameRecords.length > 10) {
                gameRecords = gameRecords.slice(0, 10);
            }
            
            updateRecordsTable();
        }

        // Update records table
        function updateRecordsTable() {
            recordsBody.innerHTML = '';
            
            gameRecords.forEach(record => {
                const row = document.createElement('tr');
                
                const wordLengthCell = document.createElement('td');
                wordLengthCell.textContent = record.wordLength;
                
                const arrangedCell = document.createElement('td');
                arrangedCell.textContent = record.arranged;
                
                const dateCell = document.createElement('td');
                dateCell.textContent = record.date;
                
                const winningCell = document.createElement('td');
                winningCell.textContent = record.winning > 0 ? `+${record.winning}` : record.winning;
                winningCell.className = record.winning > 0 ? 'win-amount' : 'loss-amount';
                
                row.appendChild(wordLengthCell);
                row.appendChild(arrangedCell);
                row.appendChild(dateCell);
                row.appendChild(winningCell);
                
                recordsBody.appendChild(row);
            });
        }

        // Show help overlay
        function showHelp() {
            helpOverlay.classList.add('active');
        }

        // Hide help overlay
        function hideHelp() {
            helpOverlay.classList.remove('active');
        }

        // Show corrections
        function showCorrections() {
            if (!roundActive) {
                showNotification('No active game to correct', 'error');
                return;
            }
            
            if (sentenceWords.length === 0) {
                showNotification('No sentence to correct yet', 'error');
                return;
            }
            
            // In a real implementation, this would show suggestions for improving the sentence
            // For now, we'll just show a notification
            showNotification('Corrections feature would suggest improvements to your sentence structure', 'info');
        }

        // Update UI
        function updateUI() {
            balanceValue.textContent = balance;
            betValue.textContent = currentBet;
        }

        // Show notification
        function showNotification(message, type) {
            // Remove existing notifications
            const existingNotifications = document.querySelectorAll('.notification');
            existingNotifications.forEach(notification => notification.remove());
            
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'}"></i>
                ${message}
            `;
            
            document.body.appendChild(notification);
            
            // Remove after 3 seconds
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // Initialize the game when the page loads
        document.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>