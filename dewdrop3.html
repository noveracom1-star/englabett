<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ocean Word Bet - 3-Letter Challenge</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"/>
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

  <style>
    :root {
      --deep-blue: #005792;
      --ocean-dark: #003355;
      --ocean-darker: #00243f;
      --panel-bg: rgba(1, 33, 51, 0.85);
      --accent: #00c6ff;
      --accent-glow: rgba(0, 198, 255, 0.4);
      --mint: #7fdbda;
      --mint-2: #50c9c6;
      --text-light: #e8fbff;
      --text-dim: #a8d8e6;
      --success: #19c37d;
      --error: #ff6b6b;
      --chip-bg: rgba(10, 58, 83, 0.6);
      --glow: 0 20px 50px rgba(0, 0, 0, 0.35);
      --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    html, body {
      height: 100%;
      font-family: 'Inter', ui-sans-serif, system-ui, sans-serif;
      color: var(--text-light);
      background: 
        radial-gradient(ellipse at 15% -10%, var(--deep-blue) 0%, var(--ocean-dark) 35%, var(--ocean-darker) 100%),
        linear-gradient(135deg, var(--deep-blue), var(--ocean-dark));
      background-attachment: fixed;
      padding: 12px;
      overflow-x: hidden;
      font-size: 16px;
    }

    /* Animated ocean surface effect */
    .ocean-surface {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(180deg, 
        rgba(0, 198, 255, 0.15) 0%, 
        transparent 10%, 
        transparent 90%, 
        rgba(0, 198, 255, 0.1) 100%);
      pointer-events: none;
      z-index: 1;
      animation: surface-shimmer 8s ease-in-out infinite;
    }
    
    @keyframes surface-shimmer {
      0%, 100% { opacity: 0.3; }
      50% { opacity: 0.7; }
    }

    /* floating bubbles */
    .bubbles {
      position: fixed;
      inset: 0;
      overflow: hidden;
      pointer-events: none;
      z-index: 2;
    }
    
    .bubble {
      position: absolute;
      bottom: -120px;
      border-radius: 999px;
      opacity: 0.15;
      background: radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.9), rgba(255, 255, 255, 0.2) 40%, rgba(255, 255, 255, 0) 65%);
      filter: blur(0.2px);
      animation: rise var(--dur) linear infinite, sway calc(var(--dur)*.6) ease-in-out infinite;
    }
    
    @keyframes rise {
      to { transform: translateY(-115vh) translateZ(0); }
    }
    
    @keyframes sway {
      50% { transform: translateX(18px); }
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      gap: 20px;
      position: relative;
      z-index: 3;
    }

    /* top nav */
    .nav {
      display: flex;
      align-items: center;
      gap: 12px;
      justify-content: space-between;
      background: rgba(0, 33, 51, 0.7);
      border: 1px solid rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      padding: 12px 16px;
      border-radius: 16px;
      box-shadow: var(--glow);
      animation: slideDown 0.5s ease-out;
    }
    
    @keyframes slideDown {
      from { transform: translateY(-20px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    
    .brand {
      display: flex;
      align-items: center;
      gap: 10px;
      font-weight: 900;
      letter-spacing: 0.4px;
    }
    
    .logo {
      width: 40px;
      height: 40px;
      border-radius: 12px;
      display: grid;
      place-items: center;
      background: linear-gradient(135deg, var(--mint), var(--mint-2));
      color: var(--ocean-darker);
      font-weight: 900;
      box-shadow: 0 6px 18px rgba(0, 0, 0, 0.25);
    }
    
    .nav-ctas {
      display: flex;
      gap: 10px;
      align-items: center;
    }
    
    .pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 8px 14px;
      border-radius: 999px;
      background: rgba(255, 255, 255, 0.08);
      border: 1px solid rgba(255, 255, 255, 0.14);
      font-weight: 700;
      font-size: 0.85rem;
    }
    
    .action {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 8px 12px;
      border-radius: 12px;
      border: 1px solid rgba(168, 230, 207, 0.35);
      background: rgba(255, 255, 255, 0.08);
      cursor: pointer;
      font-weight: 700;
      transition: var(--transition);
      font-size: 0.85rem;
      color: var(--text-light);
    }
    
    .action:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.25);
      background: rgba(255, 255, 255, 0.12);
    }

    header {
      text-align: center;
      padding: 10px 0;
      animation: fadeIn 0.6s ease-out 0.2s both;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    h1 {
      font-size: 2.2rem;
      letter-spacing: 0.5px;
      background: linear-gradient(90deg, var(--mint), var(--accent));
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
      filter: drop-shadow(0 6px 18px rgba(0, 0, 0, 0.25));
      position: relative;
      display: inline-block;
      margin-bottom: 8px;
    }
    
    h1::after {
      content: "";
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      bottom: -8px;
      width: 120px;
      height: 4px;
      border-radius: 3px;
      background: linear-gradient(90deg, var(--mint), var(--accent));
      opacity: 0.9;
    }
    
    .subtitle {
      opacity: 0.92;
      margin-top: 12px;
      font-weight: 500;
      font-size: 1rem;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
      line-height: 1.5;
      color: var(--text-dim);
    }
    
    .game-mode {
      background: linear-gradient(90deg, #ffb347, #ffcc33);
      color: var(--ocean-darker);
      padding: 8px 16px;
      border-radius: 999px;
      font-weight: 900;
      font-size: 0.9rem;
      margin-top: 12px;
      display: inline-block;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    }

    /* Game stats bar */
    .stats-bar {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      align-items: center;
      justify-content: center;
      background: rgba(0, 33, 51, 0.7);
      border: 1px solid rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      padding: 14px 20px;
      border-radius: 16px;
      box-shadow: 0 10px 28px rgba(0, 0, 0, 0.25) inset, 0 6px 16px rgba(0, 0, 0, 0.18);
      animation: fadeIn 0.6s ease-out 0.4s both;
    }
    
    .stats-bar .pill {
      font-weight: 800;
      background: rgba(0, 0, 0, 0.2);
      border: 1px solid rgba(255, 255, 255, 0.15);
    }
    
    /* Timer ring */
    .ring {
      position: relative;
      width: 50px;
      height: 50px;
      display: grid;
      place-items: center;
    }
    
    .ring svg {
      transform: rotate(-90deg);
    }
    
    .ring .num {
      position: absolute;
      font-size: 0.8rem;
      font-weight: 900;
      letter-spacing: 0.3px;
    }

    /* GAME LAYOUT */
    .game {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      align-items: start;
    }
    
    @media (max-width: 900px) {
      .game {
        grid-template-columns: 1fr;
      }
    }

    .panel {
      background: linear-gradient(180deg, rgba(1, 33, 51, 0.8), rgba(1, 26, 40, 0.8));
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 18px;
      padding: 20px;
      box-shadow: var(--glow);
      transform: translateY(0);
      animation: fadeUp 0.5s ease both;
    }
    
    @keyframes fadeUp {
      from { opacity: 0; transform: translateY(12px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .panel h2 {
      font-size: 1.2rem;
      margin-bottom: 12px;
      color: var(--mint);
      letter-spacing: 0.35px;
      text-transform: uppercase;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .panel h2 i {
      font-size: 1.1rem;
    }
    
    .lede {
      font-size: 0.95rem;
      opacity: 0.88;
      margin: -2px 0 14px;
      line-height: 1.5;
      color: var(--text-dim);
    }

    /* inputs */
    .input {
      display: grid;
      gap: 14px;
    }
    
    .field label {
      display: block;
      margin: 4px 0 8px 2px;
      opacity: 0.98;
      font-weight: 700;
      font-size: 0.9rem;
    }
    
    .field input, .field select {
      width: 100%;
      padding: 12px 14px;
      border-radius: 12px;
      border: 1px solid rgba(168, 230, 207, 0.35);
      background: rgba(255, 255, 255, 0.08);
      color: #fff;
      font-size: 1rem;
      outline: none;
      transition: var(--transition);
      text-transform: uppercase;
      font-weight: 600;
    }
    
    .field input:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 4px var(--accent-glow);
    }
    
    .btn {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 12px 16px;
      border-radius: 12px;
      border: none;
      cursor: pointer;
      font-weight: 900;
      color: var(--ocean-darker);
      background: linear-gradient(90deg, var(--mint), var(--mint-2));
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.22);
      transition: var(--transition);
      font-size: 0.95rem;
    }
    
    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 26px rgba(0, 0, 0, 0.3);
    }
    
    .btn.secondary {
      background: transparent;
      color: var(--text-light);
      border: 1px solid rgba(168, 230, 207, 0.35);
    }
    
    .btn.ghost {
      background: transparent;
      color: var(--text-light);
      border: 1px dashed rgba(168, 230, 207, 0.35);
    }
    
    .btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    /* WORD GRID */
    .search {
      margin-bottom: 14px;
      display: flex;
      gap: 8px;
      align-items: center;
      position: relative;
    }
    
    .search i {
      position: absolute;
      left: 14px;
      z-index: 1;
      color: var(--text-dim);
    }
    
    .search input {
      width: 100%;
      padding: 12px 14px 12px 40px;
      border-radius: 12px;
      border: 1px solid rgba(168, 230, 207, 0.35);
      background: rgba(255, 255, 255, 0.08);
      color: #fff;
      outline: none;
      font-size: 1rem;
    }
    
    .word-grid {
      --cols: 4;
      display: grid;
      grid-template-columns: repeat(var(--cols), 1fr);
      grid-auto-rows: minmax(32px, 1fr);
      gap: 8px;
      min-height: 200px;
    }
    
    @media (max-width: 500px) {
      .word-grid {
        --cols: 3;
      }
    }
    
    .word-item {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 10px 6px;
      border-radius: 8px;
      background: linear-gradient(145deg, rgba(168, 230, 207, 0.2), rgba(168, 230, 207, 0.08));
      border: 1px solid rgba(168, 230, 207, 0.35);
      text-align: center;
      font-weight: 800;
      letter-spacing: 0.35px;
      user-select: none;
      cursor: pointer;
      transition: var(--transition);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      font-size: 0.7rem;
      line-height: 1;
      text-shadow: 0 1px 0 rgba(0, 0, 0, 0.25);
      position: relative;
      isolation: isolate;
    }
    
    .word-item:hover {
      background: rgba(168, 230, 207, 0.32);
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.18);
    }
    
    .word-item::after {
      content: "";
      position: absolute;
      inset: 0;
      border-radius: inherit;
      background: radial-gradient(60% 90% at 50% 0%, rgba(255, 255, 255, 0.18), transparent 60%);
      opacity: 0;
      transition: opacity 0.2s ease;
    }
    
    .word-item:hover::after {
      opacity: 1;
    }

    /* bet slip (selected words) */
    .slip {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
      padding: 12px;
      border-radius: 12px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(168, 230, 207, 0.25);
      min-height: 48px;
    }
    
    .chip {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 8px 12px;
      border-radius: 999px;
      background: linear-gradient(145deg, rgba(168, 230, 207, 0.15), rgba(168, 230, 207, 0.06));
      border: 1px solid rgba(168, 230, 207, 0.35);
      font-weight: 900;
      font-size: 0.9rem;
      letter-spacing: 0.3px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.18) inset;
      animation: pop 0.2s ease;
    }
    
    @keyframes pop {
      from { transform: scale(0.92); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }
    
    .chip .x {
      width: 18px;
      height: 18px;
      display: grid;
      place-items: center;
      cursor: pointer;
      border-radius: 50%;
      border: 1px solid rgba(168, 230, 207, 0.4);
      background: rgba(255, 255, 255, 0.12);
      font-size: 0.75rem;
      line-height: 1;
      transition: var(--transition);
    }
    
    .chip .x:hover {
      background: rgba(255, 255, 255, 0.2);
    }
    
    .slip-meta {
      opacity: 0.9;
      font-size: 0.9rem;
      margin-left: auto;
      font-weight: 800;
    }

    /* review box */
    .review {
      padding: 12px;
      border-radius: 12px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px dashed rgba(168, 230, 207, 0.35);
      font-weight: 800;
      letter-spacing: 0.5px;
      font-size: 1rem;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .review i {
      color: var(--mint);
    }

    /* result section */
    .result {
      display: none;
      text-align: left;
      padding: 20px;
      border-radius: 16px;
      background: linear-gradient(180deg, rgba(1, 33, 51, 0.9), rgba(1, 26, 40, 0.9));
      border: 1px solid rgba(255, 255, 255, 0.1);
      box-shadow: var(--glow);
      animation: fadeIn 0.6s ease-out;
    }
    
    .result.win {
      outline: 2px solid rgba(25, 195, 125, 0.45);
    }
    
    .result.lose {
      outline: 2px solid rgba(242, 95, 92, 0.45);
    }
    
    .result .big {
      font-size: 1.2rem;
      margin: 8px 0 12px;
      font-weight: 900;
    }
    
    .result-list {
      margin-top: 14px;
      display: grid;
      gap: 8px;
    }
    
    .result-item {
      display: grid;
      grid-template-columns: 1fr auto;
      align-items: center;
      gap: 10px;
      padding: 10px;
      border-radius: 10px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.08);
      font-weight: 800;
      font-size: 0.95rem;
    }
    
    .tag {
      padding: 4px 8px;
      border-radius: 999px;
      font-size: 0.8rem;
      font-weight: 900;
    }
    
    .tag.win {
      background: rgba(25, 195, 125, 0.18);
      border: 1px solid rgba(25, 195, 125, 0.45);
      color: #bff3dd;
    }
    
    .tag.lose {
      background: rgba(242, 95, 92, 0.18);
      border: 1px solid rgba(242, 95, 92, 0.45);
      color: #ffd3d2;
    }
    
    /* Word bag display in results */
    .word-bag-display {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin: 16px 0;
      padding: 12px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 12px;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .letter-chip {
      width: 36px;
      height: 36px;
      display: grid;
      place-items: center;
      border-radius: 10px;
      background: linear-gradient(145deg, rgba(168, 230, 207, 0.2), rgba(168, 230, 207, 0.08));
      border: 1px solid rgba(168, 230, 207, 0.35);
      font-weight: 900;
      font-size: 1.1rem;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
    }

    footer {
      opacity: 0.8;
      text-align: center;
      margin-top: 10px;
      font-size: 0.85rem;
      color: var(--text-dim);
      animation: fadeIn 0.6s ease-out 0.8s both;
    }

    /* toast popup */
    .toast {
      position: fixed;
      left: 50%;
      top: 20px;
      transform: translateX(-50%);
      background: #fff;
      color: #00324d;
      border-radius: 12px;
      padding: 12px 16px;
      box-shadow: 0 10px 26px rgba(0, 0, 0, 0.3);
      z-index: 3000;
      display: none;
      max-width: 92%;
      font-weight: 900;
      font-size: 0.95rem;
    }
    
    .toast.show {
      display: block;
      animation: drop 0.24s ease-out;
    }
    
    @keyframes drop {
      from { transform: translate(-50%, -14px); opacity: 0; }
      to { transform: translate(-50%, 0); opacity: 1; }
    }

    /* modal */
    .modal {
      position: fixed;
      inset: 0;
      display: none;
      place-items: center;
      z-index: 2600;
      background: rgba(0, 0, 0, 0.35);
      backdrop-filter: blur(2px);
    }
    
    .modal-card {
      background: #fff;
      color: #00324d;
      border-radius: 16px;
      padding: 20px;
      max-width: 90%;
      width: 450px;
      box-shadow: 0 18px 48px rgba(0, 0, 0, 0.35);
      text-align: center;
    }
    
    .modal .btn {
      width: auto;
      margin-top: 16px;
    }

    /* progress ring timer */
    .ring {
      position: relative;
      width: 50px;
      height: 50px;
      display: grid;
      place-items: center;
    }
    
    .ring svg {
      transform: rotate(-90deg);
    }
    
    .ring .num {
      position: absolute;
      font-size: 0.8rem;
      font-weight: 900;
      letter-spacing: 0.3px;
    }

    /* shimmer effect */
    .shimmer {
      position: relative;
      overflow: hidden;
    }
    
    .shimmer::after {
      content: "";
      position: absolute;
      top: 0;
      left: -120%;
      width: 60%;
      height: 100%;
      background: linear-gradient(110deg, transparent 0%, rgba(255, 255, 255, 0.6) 45%, transparent 100%);
      animation: shimmer 3.2s ease-in-out infinite;
    }
    
    @keyframes shimmer {
      50% { left: 160%; }
    }

    /* View Results Button */
    .view-results-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 12px 16px;
      border-radius: 12px;
      border: none;
      cursor: pointer;
      font-weight: 900;
      color: var(--ocean-darker);
      background: linear-gradient(90deg, #ff9a8b, #ff6b6b);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.22);
      transition: var(--transition);
      margin-top: 14px;
      width: 100%;
      font-size: 0.95rem;
    }
    
    .view-results-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 26px rgba(0, 0, 0, 0.3);
    }
    
    /* Ads modal */
    .ads-modal {
      position: fixed;
      inset: 0;
      display: none;
      place-items: center;
      z-index: 3000;
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(4px);
    }
    
    .ads-container {
      background: #fff;
      border-radius: 16px;
      overflow: hidden;
      max-width: 90%;
      width: 400px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
    }
    
    .ads-content {
      padding: 20px;
      text-align: center;
      color: #00324d;
    }
    
    .ads-content h3 {
      margin-bottom: 15px;
      font-weight: 900;
    }
    
    .ads-media {
      width: 100%;
      max-height: 200px;
      object-fit: contain;
      margin-bottom: 15px;
      border-radius: 8px;
    }
    
    .ads-actions {
      display: flex;
      gap: 10px;
      justify-content: center;
    }
    
    .ads-timer {
      font-weight: 800;
      margin-bottom: 10px;
      color: #006aa6;
    }
    
    /* Hidden letters bag */
    #letters-bag {
      display: none;
    }
    
    /* reduced motion */
    @media (prefers-reduced-motion: reduce) {
      * {
        animation: none !important;
        transition: none !important;
      }
    }
  </style>
</head>
<body>
  <!-- Ocean surface effect -->
  <div class="ocean-surface"></div>

  <!-- ambient audio -->
  <audio id="bg-music" loop>
    <source src="ocean-waves.mp3" type="audio/mpeg">
  </audio>

  <!-- bubbles -->
  <div class="bubbles" aria-hidden="true" id="bubbles"></div>

  <div class="container" role="application">
    <!-- nav -->
    <div class="nav" aria-label="Top Navigation">
      <div class="brand">
        <div class="logo">
          <i class="fas fa-water"></i>
        </div>
        <div>
          <div style="font-size:1rem">Ocean Word Bet</div>
          <small style="opacity:.8;font-weight:700; font-size: 0.75rem;">3-Letter Challenge</small>
        </div>
      </div>
      <div class="nav-ctas">
        <div class="pill" title="Current Balance"><i class="fa-solid fa-wallet"></i> <span id="balance">‚Ç¶1000</span></div>
        <button id="music-toggle" class="action" aria-pressed="true" title="Toggle Ocean Ambience">
          <i class="fa-solid fa-music"></i> <span>Sound On</span>
        </button>
        <button id="help-btn" class="action" title="How to play" aria-haspopup="dialog"><i class="fa-regular fa-circle-question"></i> Help</button>
      </div>
    </div>

    <header>
      <h1>Ocean Word Challenge</h1>
      <div class="game-mode">3-LETTER WORDS ONLY</div>
      <p class="subtitle">Form valid 3-letter words using the available letters. <strong>Key letter = O</strong>. Win per correct word, lose per incorrect pick. Choose wisely.</p>
    </header>

    <div class="stats-bar" role="status" aria-live="polite">
      <div class="pill"><i class="fa-solid fa-key"></i> Key Letter: <b>O</b></div>
      <div class="pill" style="gap:10px">
        <i class="fa-regular fa-clock"></i>
        <div class="ring" aria-label="Round timer">
          <svg width="50" height="50">
            <circle cx="25" cy="25" r="22" stroke="rgba(255,255,255,.15)" stroke-width="5" fill="none"></circle>
            <circle id="ring-arc" cx="25" cy="25" r="22" stroke="url(#grad)" stroke-width="5" stroke-linecap="round" fill="none" stroke-dasharray="138" stroke-dashoffset="0"/>
            <defs>
              <linearGradient id="grad" x1="0" x2="1">
                <stop offset="0%" stop-color="#a8e6cf"/>
                <stop offset="100%" stop-color="#6ed3cf"/>
              </linearGradient>
            </defs>
          </svg>
          <div class="num" id="timer">03:00</div>
        </div>
      </div>
      <div class="pill"><i class="fa-solid fa-letters"></i> Letters: <span id="bag-letters">‚Äî</span></div>
    </div>

    <div class="game">
      <!-- Left: input / actions -->
      <section class="panel" aria-labelledby="guess-title">
        <h2 id="guess-title"><i class="fas fa-pen"></i> Your Guess</h2>
        <p class="lede">Enter a 3-letter word built from the current letter bag. Each correct guess earns your bet; each miss deducts it. Add up to 10 picks per round.</p>

        <div class="input">
          <div class="field">
            <label for="word-input">Enter 3-Letter Word</label>
            <input id="word-input" type="text" placeholder="Type your word..." maxlength="3" autocomplete="off" aria-describedby="review-text" />
          </div>

          <div class="review" id="review-box" aria-live="polite">
            <i class="fas fa-eye"></i> Review: <span id="review-text">‚Äî</span>
          </div>

          <div style="display:flex;gap:10px;flex-wrap:wrap">
            <button id="add-word" class="btn secondary" style="flex:1"><i class="fa-solid fa-plus"></i> Add to Bet Slip</button>
            <button id="clear-slip" class="btn ghost" style="flex:0 0 auto"><i class="fa-regular fa-trash-can"></i> Clear</button>
          </div>

          <div class="field">
            <label>Bet Slip (<span id="slip-count">0</span>/10)</label>
            <div id="bet-slip" class="slip">
              <span style="opacity:.8">No words added yet</span>
            </div>
            <div class="slip-meta" id="slip-meta">Total: ‚Ç¶0</div>
          </div>

          <div class="field" style="display:grid; grid-template-columns: 1fr auto; gap:10px; align-items:end">
            <div>
              <label for="bet-amount">Bet Amount <small>(per word, Min 50)</small></label>
              <input id="bet-amount" type="number" value="50" min="50" inputmode="numeric" />
            </div>
            <button id="submit-btn" class="btn shimmer" title="Place your bet now"><i class="fa-solid fa-coins"></i> Place Bet</button>
          </div>

          <div style="display:flex; gap:10px; flex-wrap:wrap">
            <button id="hint-btn" class="btn secondary"><i class="fa-regular fa-lightbulb"></i> Get Hint</button>
            <button id="play-again" class="btn ghost"><i class="fa-solid fa-rotate-right"></i> New Round</button>
          </div>
          
          <!-- View Results Button -->
          <button id="view-results" class="view-results-btn">
            <i class="fa-solid fa-chart-simple"></i> View Results
          </button>
        </div>
      </section>

      <!-- Right: word list -->
      <section class="panel" aria-labelledby="list-title">
        <h2 id="list-title"><i class="fas fa-list"></i> 3-Letter O-Words</h2>
        <p class="lede">Browse curated 3-letter "O" starters. Tap to add instantly to your slip.</p>

        <div class="search">
          <i class="fa-solid fa-magnifying-glass" aria-hidden="true"></i>
          <input id="search-words" type="text" placeholder="Search words..." aria-label="Search O-words"/>
        </div>

        <div id="word-grid" class="word-grid" role="list"><div class="word-item">Loading‚Ä¶</div></div>
        <p style="opacity:.85;margin-top:12px;font-size:.9rem">Tip: Tap a word to add it to your bet slip. Max 10 words.</p>
      </section>
    </div>

    <!-- Result / countdown -->
    <section id="result" class="result" aria-live="polite">
      <h2><i class="fas fa-trophy"></i> Result</h2>
      <div id="result-msg" class="big"></div>
      <div id="word-bag-result" class="word-bag-display"></div>
      <div id="result-list" class="result-list"></div>
    </section>

    <footer><p>From ENGLAGIP powered by AITECH ‚Ä¢ Ocean Word Challenge ¬© 2025 ‚Ä¢ Crafted for clarity, speed, and thrill.</p></footer>
  </div>

  <!-- Help modal -->
  <div id="help-modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="help-title">
    <div class="modal-card">
      <h3 id="help-title" style="font-weight:900;margin-bottom:12px">How to Play</h3>
      <div style="text-align:left; font-weight:700; line-height:1.5; margin-bottom:16px">
        <ol style="padding-left:20px">
          <li>Form <b>3-letter words</b> using only the <b>Letters Bag</b>. Key letter is <b>O</b>.</li>
          <li>Add up to <b>10</b> words to your bet slip.</li>
          <li>Set your <b>Bet Amount</b> (at least ‚Ç¶50 per word).</li>
          <li>Place your bet before time runs out.</li>
          <li>Each correct word pays +bet; incorrect deducts ‚àíbet.</li>
        </ol>
      </div>
      <button id="help-ok" class="btn">Got it</button>
    </div>
  </div>

  <!-- Hint modal -->
  <div id="hint-modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="hint-title">
    <div class="modal-card">
      <h3 id="hint-title" style="font-weight:900;margin-bottom:12px">Hint</h3>
      <div id="hint-text" style="font-weight:800;margin-bottom:16px">Hint</div>
      <button id="hint-ok" class="btn">OK</button>
    </div>
  </div>

  <!-- Ads modal -->
  <div id="ads-modal" class="ads-modal">
    <div class="ads-container">
      <div class="ads-content">
        <h3>Watch an Ad for Another Hint</h3>
        <div id="ads-timer" class="ads-timer">Ad will play in 5 seconds</div>
        <div id="ads-media-container"></div>
        <div class="ads-actions">
          <button id="ads-cancel" class="btn secondary">Cancel</button>
          <button id="ads-watch" class="btn">Watch Ad</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Toast -->
  <div id="toast" class="toast" role="status" aria-live="assertive"></div>

<script>
(() => {
  // ---- STATE ----
  let dict=[], oWords=[], validWords=[], availableLetters=[], keyword="";
  let balance=1000, currency="‚Ç¶";
  let roundActive=true, timerInterval=null;
  const MAX_SLIP = 10;
  let slip = []; // selected words
  const ROUND_SECONDS = 180; // 3 minutes
  let hintUsed = false;
  let betHistory = JSON.parse(localStorage.getItem('ocean_word_bet_history') || '[]');
  
  // Firebase configuration
  const firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "YOUR_AUTH_DOMAIN",
    projectId: "YOUR_PROJECT_ID",
    storageBucket: "YOUR_STORAGE_BUCKET",
    messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
    appId: "YOUR_APP_ID"
  };
  
  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  // ---- DOM ----
  const els = {
    balance: document.getElementById('balance'),
    timer: document.getElementById('timer'),
    ringArc: document.getElementById('ring-arc'),
    grid: document.getElementById('word-grid'),
    input: document.getElementById('word-input'),
    bet: document.getElementById('bet-amount'),
    result: document.getElementById('result'),
    resultMsg: document.getElementById('result-msg'),
    resultList: document.getElementById('result-list'),
    wordBagResult: document.getElementById('word-bag-result'),
    search: document.getElementById('search-words'),
    toast: document.getElementById('toast'),
    hintModal: document.getElementById('hint-modal'),
    hintText: document.getElementById('hint-text'),
    reviewText: document.getElementById('review-text'),
    reviewBox: document.getElementById('review-box'),
    betSlip: document.getElementById('bet-slip'),
    slipCount: document.getElementById('slip-count'),
    addWord: document.getElementById('add-word'),
    clearSlip: document.getElementById('clear-slip'),
    bag: document.getElementById('bag-letters'),
    playAgain: document.getElementById('play-again'),
    helpBtn: document.getElementById('help-btn'),
    helpModal: document.getElementById('help-modal'),
    helpOk: document.getElementById('help-ok'),
    musicToggle: document.getElementById('music-toggle'),
    bg: document.getElementById('bg-music'),
    slipMeta: document.getElementById('slip-meta'),
    bubbles: document.getElementById('bubbles'),
    viewResults: document.getElementById('view-results'),
    adsModal: document.getElementById('ads-modal'),
    adsMediaContainer: document.getElementById('ads-media-container'),
    adsTimer: document.getElementById('ads-timer'),
    adsCancel: document.getElementById('ads-cancel'),
    adsWatch: document.getElementById('ads-watch')
  };

  // ---- UTIL ----
  const sleep = ms => new Promise(r=>setTimeout(r,ms));
  const shuffle = a => {for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]];}return a;};
  const rand = (n)=>Math.floor(Math.random()*n);
  const randomLetters = (c) => Array.from({length:c},()=> "abcdefghijklmnopqrstuvwxyz"[Math.floor(Math.random()*26)]).join("");
  const canFormWord = (word, letters) => {
    let bag=[...letters]; for(const ch of word){const k=bag.indexOf(ch); if(k<0) return false; bag.splice(k,1);} return true;
  };
  const formatMoney = (n)=> currency + n.toLocaleString();

  function notify(msg, type="info"){
    els.toast.textContent = msg;
    els.toast.style.color = type==="error" ? "#6a0000" : "#00324d";
    els.toast.classList.add('show');
    setTimeout(()=>els.toast.classList.remove('show'), 1400);
  }

  // progress ring (circumference 2œÄr with r=22 ‚âà 138)
  const RING_LEN = 138;
  function setRing(progress){ // 1.0 -> full, 0 -> empty
    const offset = RING_LEN * (1 - progress);
    els.ringArc.setAttribute('stroke-dasharray', RING_LEN);
    els.ringArc.setAttribute('stroke-dashoffset', offset.toFixed(2));
  }

  function renderGrid(words){
    const list = words.slice(0, 30);
    els.grid.innerHTML = "";
    if(!list.length){
      els.grid.innerHTML = "<div class='word-item'>No words</div>";
      return;
    }
    list.forEach(w=>{
      const d=document.createElement('div');
      d.className='word-item';
      d.setAttribute('role','listitem');
      d.textContent = w.toUpperCase();
      d.title = "Click to add: " + w.toUpperCase();
      d.onclick = ()=>{
        els.input.value = w.toUpperCase();
        updateReview();
        addToSlip(w);
      };
      els.grid.appendChild(d);
    });
  }

  function renderSlip(){
    els.betSlip.innerHTML = "";
    if(slip.length === 0){
      els.betSlip.innerHTML = "<span style='opacity:.8'>No words added yet</span>";
    } else {
      slip.forEach((w,idx)=>{
        const chip = document.createElement('div');
        chip.className = 'chip';
        const span = document.createElement('span');
        span.textContent = w.toUpperCase();
        const x = document.createElement('div');
        x.className = 'x';
        x.setAttribute('title','Remove');
        x.setAttribute('aria-label','Remove '+w.toUpperCase());
        x.innerHTML = '&times;';
        x.onclick = ()=>{ removeFromSlip(idx); };
        chip.appendChild(span);
        chip.appendChild(x);
        els.betSlip.appendChild(chip);
      });
    }
    els.slipCount.textContent = slip.length;
    const bet = Math.max(50, parseInt(els.bet.value||"0",10) || 0);
    els.slipMeta.textContent = "Total: " + formatMoney(bet * slip.length);
  }

  function addToSlip(raw){
    const w = (raw||"").trim().toLowerCase();
    if(!w) return notify("Type a word first");
    if(w.length !== 3) return notify("Word must be exactly 3 letters","error");
    if(!w.includes('o')) return notify("Each word must include O","error");
    if(slip.includes(w)) return notify("Already in your slip");
    if(slip.length>=MAX_SLIP) return notify("Bet slip full (max 10)","error");
    slip.push(w);
    renderSlip();
  }

  function removeFromSlip(index){
    slip.splice(index,1);
    renderSlip();
  }

  function clearSlip(){
    slip = [];
    renderSlip();
  }

  function updateReview(){
    const val = els.input.value.trim().toUpperCase();
    els.reviewText.textContent = val || "‚Äî";
  }

  function startTimer(){
    let t=ROUND_SECONDS;
    clearInterval(timerInterval);
    function tick(){
      const m=Math.floor(t/60), s=t%60;
      els.timer.textContent=`${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
      setRing(t/ROUND_SECONDS);
      if(t<=0){ clearInterval(timerInterval); roundActive=false; notify("‚è±Ô∏è Time up!", "error"); }
      t--;
    }
    tick(); timerInterval=setInterval(tick,1000);
  }

  function setLettersBag(letters){
    els.bag.textContent = letters.map(x=>x.toUpperCase()).join(" ");
  }
  
  function displayWordBag(letters) {
    els.wordBagResult.innerHTML = "";
    letters.forEach(letter => {
      const chip = document.createElement('div');
      chip.className = 'letter-chip';
      chip.textContent = letter.toUpperCase();
      els.wordBagResult.appendChild(chip);
    });
  }

  function startNewRound(){
    els.result.style.display="none";
    els.result.classList.remove('win','lose');
    roundActive=true;
    hintUsed = false;
    els.input.value="";
    updateReview();
    clearSlip();

    // keyword from O words; ensure presence of 'o'
    keyword = (oWords[rand(oWords.length)] || "oil").substring(0, 3);
    const extra = randomLetters(rand(2)+2);
    availableLetters = shuffle((keyword+extra).split(""));
    validWords = dict.filter(w => w.length === 3 && canFormWord(w, availableLetters));

    // UI
    setLettersBag(availableLetters);
    renderGrid(shuffle(oWords).slice(0,30));
    startTimer();
  }

  // Save bet history
  function saveBetHistory(result) {
    betHistory.unshift({
      date: new Date().toISOString(),
      words: slip,
      betAmount: parseInt(els.bet.value, 10),
      result: result,
      balance: balance,
      wordBag: availableLetters
    });
    
    // Keep only last 20 bets
    if (betHistory.length > 20) {
      betHistory = betHistory.slice(0, 20);
    }
    
    localStorage.setItem('ocean_word_bet_history', JSON.stringify(betHistory));
  }

  // Load ads from Firestore
  async function loadAds() {
    try {
      const snapshot = await db.collection('ads').get();
      const ads = [];
      snapshot.forEach(doc => {
        ads.push(doc.data());
      });
      return ads;
    } catch (error) {
      console.error("Error loading ads:", error);
      return [];
    }
  }

  // Show ad for hint
  async function showAdForHint() {
    const ads = await loadAds();
    if (ads.length === 0) {
      notify("No ads available at the moment", "error");
      return false;
    }
    
    const randomAd = ads[Math.floor(Math.random() * ads.length)];
    els.adsMediaContainer.innerHTML = '';
    
    // Create appropriate media element based on file type
    let mediaElement;
    if (randomAd.url.endsWith('.mp4')) {
      mediaElement = document.createElement('video');
      mediaElement.controls = true;
      mediaElement.autoplay = true;
      mediaElement.style.width = '100%';
    } else if (randomAd.url.endsWith('.mp3')) {
      mediaElement = document.createElement('audio');
      mediaElement.controls = true;
      mediaElement.autoplay = true;
    } else if (randomAd.url.endsWith('.png') || randomAd.url.endsWith('.jpg') || randomAd.url.endsWith('.jpeg')) {
      mediaElement = document.createElement('img');
      mediaElement.style.maxWidth = '100%';
      mediaElement.style.maxHeight = '150px';
    }
    
    mediaElement.src = randomAd.url;
    els.adsMediaContainer.appendChild(mediaElement);
    
    // Show ad modal
    els.adsModal.style.display = 'grid';
    
    // Countdown timer
    let countdown = 5;
    const countdownInterval = setInterval(() => {
      els.adsTimer.textContent = `Ad will play in ${countdown} seconds`;
      countdown--;
      
      if (countdown < 0) {
        clearInterval(countdownInterval);
        els.adsWatch.click();
      }
    }, 1000);
    
    // Return a promise that resolves when the ad is watched
    return new Promise((resolve) => {
      els.adsWatch.onclick = () => {
        clearInterval(countdownInterval);
        els.adsModal.style.display = 'none';
        resolve(true);
      };
      
      els.adsCancel.onclick = () => {
        clearInterval(countdownInterval);
        els.adsModal.style.display = 'none';
        resolve(false);
      };
    });
  }

  // ---- EVENTS ----
  els.input.addEventListener('input', function() {
    this.value = this.value.replace(/[^a-zA-Z]/g, '').substring(0, 3);
    updateReview();
  });
  els.addWord.addEventListener('click', ()=>{ addToSlip(els.input.value); });
  els.input.addEventListener('keydown', (e)=>{ if(e.key==='Enter'){ e.preventDefault(); addToSlip(els.input.value); }});
  els.clearSlip.addEventListener('click', clearSlip);
  els.bet.addEventListener('input', renderSlip);
  els.playAgain.addEventListener('click', startNewRound);
  
  // View Results Button
  els.viewResults.addEventListener('click', () => {
    // Create a results page in the same HTML file
    document.body.innerHTML = `
      <div style="padding: 20px; max-width: 800px; margin: 0 auto;">
        <h1 style="text-align: center; color: white; margin-bottom: 20px;">Your Bet History</h1>
        <div style="display: flex; justify-content: center; margin-bottom: 20px;">
          <button id="back-to-game" style="padding: 10px 20px; background: #6ed3cf; border: none; border-radius: 8px; font-weight: bold; cursor: pointer;">
            Back to Game
          </button>
        </div>
        <div id="results-container" style="background: rgba(255,255,255,0.1); border-radius: 12px; padding: 20px;"></div>
      </div>
    `;
    
    const resultsContainer = document.getElementById('results-container');
    const backButton = document.getElementById('back-to-game');
    
    if (betHistory.length === 0) {
      resultsContainer.innerHTML = '<p style="text-align: center; color: white;">No bet history yet.</p>';
    } else {
      let html = '';
      betHistory.forEach(bet => {
        const date = new Date(bet.date).toLocaleString();
        const netResult = bet.result >= 0 ? 
          `<span style="color: #19c37d;">+‚Ç¶${bet.result}</span>` : 
          `<span style="color: #f25f5c;">-‚Ç¶${Math.abs(bet.result)}</span>`;
        
        // Display word bag
        let wordBagHtml = '<div style="display: flex; gap: 5px; margin: 10px 0;">';
        if (bet.wordBag) {
          bet.wordBag.forEach(letter => {
            wordBagHtml += `<div style="width: 30px; height: 30px; display: grid; place-items: center; background: rgba(168,230,207,.2); border-radius: 6px; font-weight: bold;">${letter.toUpperCase()}</div>`;
          });
        }
        wordBagHtml += '</div>';
        
        html += `
          <div style="background: rgba(0,0,0,0.2); padding: 15px; border-radius: 8px; margin-bottom: 10px;">
            <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
              <strong style="color: white;">${date}</strong>
              <strong>${netResult}</strong>
            </div>
            <div>Word Bag: ${wordBagHtml}</div>
            <div style="color: #ccc;">
              <div>Words: ${bet.words.join(', ').toUpperCase()}</div>
              <div>Bet Amount: ‚Ç¶${bet.betAmount} per word</div>
              <div>Final Balance: ‚Ç¶${bet.balance}</div>
            </div>
          </div>
        `;
      });
      resultsContainer.innerHTML = html;
    }
    
    backButton.addEventListener('click', () => {
      location.reload();
    });
  });

  document.getElementById('submit-btn').addEventListener('click', async ()=>{
    if(!roundActive){
      notify("Round finished. Start a new one.", "error");
      els.result.scrollIntoView({behavior:"smooth",block:"center"});
      return;
    }

    if(slip.length===0 && els.input.value.trim()){
      addToSlip(els.input.value);
    }
    if(slip.length===0){ notify("Add at least one word to bet on","error"); return; }

    const bet = parseInt(els.bet.value,10);
    if(isNaN(bet) || bet<50){ notify("Minimum bet is ‚Ç¶50", "error"); return; }
    const totalCost = bet * slip.length;
    if(totalCost>balance){ notify("Insufficient balance for all words", "error"); return; }

    els.result.style.display="block";
    els.result.classList.remove('win','lose');
    els.resultMsg.innerHTML = `‚è≥ Checking <b>${slip.length}</b> word(s) in <b>5</b>‚Ä¶`;
    els.resultList.innerHTML = "";
    displayWordBag(availableLetters);
    els.result.scrollIntoView({behavior:"smooth",block:"start"});

    roundActive=false;
    for(let c=5;c>=1;c--){
      els.resultMsg.innerHTML = `‚è≥ Checking <b>${slip.length}</b> word(s) in <b>${c}</b>‚Ä¶`;
      await sleep(600);
    }

    // Evaluate each word
    let net = 0;
    slip.forEach(w=>{
      const ok = validWords.includes(w);
      const item = document.createElement('div');
      item.className = 'result-item';
      const left = document.createElement('div');
      left.textContent = w.toUpperCase();
      const right = document.createElement('div');
      const tag = document.createElement('span');
      tag.className = 'tag ' + (ok?'win':'lose');
      tag.textContent = (ok ? '+' : '‚àí') + currency + bet;
      right.appendChild(tag);
      item.appendChild(left);
      item.appendChild(right);
      els.resultList.appendChild(item);
      net += ok ? bet : -bet;
    });

    balance += net;
    els.balance.textContent = currency + balance;
    localStorage.setItem('ocean_word_bet_balance', String(balance));
    
    // Save to bet history
    saveBetHistory(net);

    // Custom congratulations based on result
    if (net > 0) {
      els.result.classList.add('win');
      if (net >= 500) {
        els.resultMsg.innerHTML = `üéâ AMAZING! You won <b>+${currency}${net}</b>! You're a word master!`;
      } else if (net >= 200) {
        els.resultMsg.innerHTML = `üéâ GREAT JOB! You won <b>+${currency}${net}</b>! Keep it up!`;
      } else {
        els.resultMsg.innerHTML = `üéâ Well done! You netted <b>+${currency}${net}</b> on ${slip.length} word(s).`;
      }
      notify("‚úÖ You won!");
    } else if (net < 0) {
      els.result.classList.add('lose');
      if (net <= -500) {
        els.resultMsg.innerHTML = `üò¢ Tough luck! You lost <b>${currency}${Math.abs(net)}</b>. Better luck next time!`;
      } else if (net <= -200) {
        els.resultMsg.innerHTML = `üòï Unfortunate! You lost <b>${currency}${Math.abs(net)}</b>. Try again!`;
      } else {
        els.resultMsg.innerHTML = `‚ùå Done! You lost <b>${currency}${Math.abs(net)}</b> on ${slip.length} word(s).`;
      }
      notify("‚úñÔ∏è Better luck next time");
    } else {
      els.resultMsg.innerHTML = `‚ûñ Break even! No gain, no loss on ${slip.length} word(s).`;
      notify("‚ûñ Break even!");
    }
  });

  // search
  let tId=null;
  els.search.addEventListener('input', (e)=>{
    const q=e.target.value.toLowerCase();
    clearTimeout(tId);
    tId=setTimeout(()=>{
      const filtered = oWords.filter(w => w.startsWith('o') && w.includes(q) && w.length === 3);
      renderGrid(filtered.slice(0,30));
    },120);
  });

  // help
  els.helpBtn.addEventListener('click', ()=> els.helpModal.style.display='grid');
  els.helpOk.addEventListener('click', ()=> els.helpModal.style.display='none');

  // hint
  document.getElementById('hint-btn').addEventListener('click', async ()=>{
    if (!keyword) return;
    
    if (hintUsed) {
      const watched = await showAdForHint();
      if (!watched) return;
    }
    
    const hintLetter = keyword[rand(keyword.length)].toUpperCase();
    els.hintText.innerHTML = `üí° The keyword contains the letter <b>${hintLetter}</b>`;
    els.hintModal.style.display='grid';
    hintUsed = true;
  });
  document.getElementById('hint-ok').addEventListener('click', ()=> els.hintModal.style.display='none');

  // music toggle
  function syncMusicUI(){
    const on = !els.bg.paused;
    els.musicToggle.setAttribute('aria-pressed', String(on));
    els.musicToggle.querySelector('span').textContent = on ? "Sound On" : "Sound Off";
    els.musicToggle.querySelector('i').className = on ? "fa-solid fa-music" : "fa-solid fa-music-slash";
  }
  els.musicToggle.addEventListener('click', async ()=>{
    if(els.bg.paused){ try{ await els.bg.play(); }catch(e){} } else { els.bg.pause(); }
    syncMusicUI();
  });

  // bubbles
  function spawnBubbles(){
    const n = 18;
    for(let i=0;i<n;i++){
      const b = document.createElement('div');
      b.className='bubble';
      const size = 10 + Math.random()*26;
      b.style.width = size+'px';
      b.style.height = size+'px';
      b.style.left = (Math.random()*100)+'%';
      b.style.setProperty('--dur', (12 + Math.random()*18) + 's');
      b.style.animationDelay = (-Math.random()*20)+'s';
      els.bubbles.appendChild(b);
    }
  }

  // dictionary
  async function loadDict(){
    const res = await fetch("https://raw.githubusercontent.com/dwyl/english-words/master/words_alpha.txt");
    const text = await res.text();
    return text.split("\n").map(x=>x.trim().toLowerCase());
  }

  (async function init(){
    // restore balance
    const saved = parseInt(localStorage.getItem('ocean_word_bet_balance')||"0",10);
    if(!isNaN(saved) && saved>0){ balance = saved; }
    els.balance.textContent = currency + balance;

    notify("Loading dictionary‚Ä¶");
    try{
      dict = await loadDict();
      // Filter for 3-letter words starting with 'o'
      oWords = dict.filter(w=>w.startsWith('o') && w.length === 3);
      notify("Ready!");
    }catch(e){
      notify("Failed to load dictionary","error");
      // fallback minimal dictionary if fetch fails
      dict = ["oil","own","one","out","off","old","owl","oak","orb","ode","ohm","ore"];
      oWords = dict.filter(w=>w.startsWith('o') && w.length === 3);
    }

    // start audio automatically on init (attempt autoplay)
    try{ 
      await els.bg.play(); 
      syncMusicUI(); // sync UI to reflect "on" state
    } catch(e) {
      console.warn("Autoplay failed, user interaction may be required.");
      syncMusicUI(); // still sync UI in case it was paused
    }

    // visuals
    spawnBubbles();

    // kick off round
    startNewRound();
    updateReview();
  })();
})();
</script>
</body>
</html>